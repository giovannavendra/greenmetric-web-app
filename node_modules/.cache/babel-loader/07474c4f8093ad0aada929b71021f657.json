{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/giovanna/Documents/MC855/green-metric/web-app/src/components/MetricsEditor.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Form, Checkbox } from 'semantic-ui-react';\nimport { getMetricbyId, putMetric, postMetric } from '../utils/data';\nconst typesOptions = [{\n  key: '1',\n  text: 'Inteiro',\n  value: 'INTEGER'\n}, {\n  key: '2',\n  text: 'Real',\n  value: 'FLOAT'\n}, {\n  key: '3',\n  text: 'Opções',\n  value: 'SELECT'\n}];\nconst hasDataOptions = [{\n  key: '1',\n  text: 'Sim',\n  value: true\n}, {\n  key: '2',\n  text: 'Não',\n  value: false\n}];\nconst evidenceRequirementOptions = [{\n  key: '1',\n  text: 'Nenhuma evidência',\n  value: 'NONE'\n}, {\n  key: '2',\n  text: 'Evidência opcional',\n  value: 'OPTIONAL'\n}, {\n  key: '3',\n  text: 'Evidência obrigatória',\n  value: 'REQUIRED'\n}];\nconst defaultState = {\n  valueType: '',\n  hasData: '',\n  evidenceRequirement: '',\n  unit: '',\n  id: '',\n  title: '',\n  description: '',\n  code: '',\n  expression: '',\n  dependencies: '',\n  data: null\n};\n\nconst MetricsEditor = ({\n  id\n}) => {\n  _s();\n\n  const [info, setInfo] = useState({ ...defaultState\n  });\n  const [isNewMetric, setIsNewMetric] = useState(true);\n  const [options, setOptions] = useState([]);\n  const [orignalValueType, setOriginalValueType] = useState(null);\n  useEffect(() => {\n    const fetchData = async id => {\n      if (!id) return;\n\n      try {\n        const {\n          data\n        } = await getMetricbyId(id);\n        setIsNewMetric(!!!data);\n        setInfo(data);\n        setOriginalValueType(data.valueType);\n      } catch {\n        setIsNewMetric(true);\n        setInfo({ ...defaultState,\n          id: `${id}/`\n        });\n      }\n    };\n\n    fetchData(id);\n  }, [id]);\n\n  const handleChange = (name, value) => {\n    setInfo({ ...info,\n      [name]: value\n    });\n  }; // TODO, it makes the metric always be a SELECT\n\n\n  const onSubmit = async () => {\n    let data = info.data;\n    if (!info.data || orignalValueType !== info.valueType) data = info.valueType === 'SELECT' ? {\n      currentOption: options[0],\n      options: options\n    } : '';\n    const submitInfo = { ...info,\n      data\n    };\n\n    try {\n      if (isNewMetric) await postMetric(submitInfo);else await putMetric(submitInfo);\n      window.location.reload();\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  const addOption = () => {\n    setOptions([...options, '']);\n  };\n\n  const removeOption = () => {\n    setOptions(options.slice(0, -1));\n  };\n\n  const handleChangeOption = (index, value) => {\n    const newOptions = [...options];\n    newOptions[index] = value;\n    setOptions(newOptions);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Form, {\n    onSubmit: onSubmit,\n    children: [/*#__PURE__*/_jsxDEV(Form.Field, {\n      children: /*#__PURE__*/_jsxDEV(Checkbox, {\n        checked: !isNewMetric,\n        label: 'Atualizar ID',\n        onChange: (e, {\n          checked\n        }) => {\n          setIsNewMetric(!checked);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n      widths: \"equal\",\n      children: [/*#__PURE__*/_jsxDEV(Form.Select, {\n        options: typesOptions,\n        placeholder: \"Tipo\",\n        label: \"Tipo\",\n        name: \"valueType\",\n        value: info.valueType,\n        onChange: (e, {\n          name,\n          value\n        }) => handleChange(name, value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Form.Select, {\n        options: hasDataOptions,\n        placeholder: \"O campo \\xE9 edit\\xE1vel?\",\n        label: \"Dados\",\n        name: \"hasData\",\n        value: info.hasData,\n        onChange: (e, {\n          name,\n          value\n        }) => handleChange(name, value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n      widths: \"equal\",\n      children: [/*#__PURE__*/_jsxDEV(Form.Select, {\n        options: evidenceRequirementOptions,\n        placeholder: \"O campo possui evid\\xEAncia?\",\n        label: \"Evid\\xEAncia\",\n        name: \"evidenceRequirement\",\n        value: info.evidenceRequirement,\n        onChange: (e, {\n          name,\n          value\n        }) => handleChange(name, value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Form.Input, {\n        label: \"Unidade\",\n        placeholder: \"Ex: m\\xB2, %\",\n        name: \"unit\",\n        value: info.unit,\n        onChange: ({\n          target\n        }) => handleChange(target.name, target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n      widths: \"equal\",\n      children: [/*#__PURE__*/_jsxDEV(Form.Input, {\n        disabled: !isNewMetric,\n        label: \"ID\",\n        placeholder: \"Valor \\xFAnico de identifica\\xE7\\xE3o da m\\xE9trica no banco de dados\",\n        name: \"id\",\n        value: info.id,\n        onChange: ({\n          target\n        }) => handleChange(target.name, target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Form.Input, {\n        label: \"T\\xEDtulo\",\n        placeholder: \"Nome da m\\xE9trica\",\n        name: \"title\",\n        value: info.title,\n        onChange: ({\n          target\n        }) => handleChange(target.name, target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Form.TextArea, {\n      label: \"Descri\\xE7\\xE3o\",\n      placeholder: \"Descreva em palavras como calcular esta m\\xE9trica\",\n      name: \"description\",\n      value: info.description,\n      onChange: ({\n        target\n      }) => handleChange(target.name, target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Form.Input, {\n      label: \"Code\",\n      placeholder: \"Valor usado para cria\\xE7\\xE3o do dashboard\",\n      name: \"code\",\n      value: info.code,\n      onChange: ({\n        target\n      }) => handleChange(target.name, target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Form.Input, {\n      label: \"Express\\xE3o\",\n      placeholder: \"F\\xF3rmula matem\\xE1tica para calcular a m\\xE9trica\",\n      name: \"expression\",\n      value: info.expression,\n      onChange: ({\n        target\n      }) => handleChange(target.name, target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }, this), info.valueType === 'SELECT' && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Op\\xE7\\xF5es\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 21\n      }, this), options.map((el, index) => /*#__PURE__*/_jsxDEV(Form.Input, {\n        placeholder: \"Op\\xE7\\xE3o 1\",\n        name: \"options\",\n        value: el.value,\n        onChange: ({\n          target\n        }) => handleChangeOption(index, target.value)\n      }, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 25\n      }, this)), /*#__PURE__*/_jsxDEV(Form.Group, {\n        children: [/*#__PURE__*/_jsxDEV(Form.Button, {\n          color: \"green\",\n          type: \"button\",\n          onClick: () => {\n            addOption();\n          },\n          children: \"Adicionar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Form.Button, {\n          color: \"red\",\n          type: \"button\",\n          onClick: () => {\n            removeOption();\n          },\n          children: \"Remover\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"app-footer\",\n      children: /*#__PURE__*/_jsxDEV(Form.Button, {\n        primary: true,\n        className: \"centered\",\n        color: \"black\",\n        type: \"submit\",\n        children: \"Enviar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 102,\n    columnNumber: 9\n  }, this);\n};\n\n_s(MetricsEditor, \"AhB5RVZLc9fxPBOl/PEjBckbLks=\");\n\n_c = MetricsEditor;\nexport default MetricsEditor;\n\nvar _c;\n\n$RefreshReg$(_c, \"MetricsEditor\");","map":{"version":3,"sources":["/Users/giovanna/Documents/MC855/green-metric/web-app/src/components/MetricsEditor.jsx"],"names":["React","useEffect","useState","Form","Checkbox","getMetricbyId","putMetric","postMetric","typesOptions","key","text","value","hasDataOptions","evidenceRequirementOptions","defaultState","valueType","hasData","evidenceRequirement","unit","id","title","description","code","expression","dependencies","data","MetricsEditor","info","setInfo","isNewMetric","setIsNewMetric","options","setOptions","orignalValueType","setOriginalValueType","fetchData","handleChange","name","onSubmit","currentOption","submitInfo","window","location","reload","e","console","log","addOption","removeOption","slice","handleChangeOption","index","newOptions","checked","target","map","el"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { Form, Checkbox } from 'semantic-ui-react'\nimport { getMetricbyId, putMetric, postMetric } from '../utils/data'\n\nconst typesOptions = [\n    { key: '1', text: 'Inteiro', value: 'INTEGER' },\n    { key: '2', text: 'Real', value: 'FLOAT' },\n    { key: '3', text: 'Opções', value: 'SELECT' },\n]\n\nconst hasDataOptions = [\n    { key: '1', text: 'Sim', value: true },\n    { key: '2', text: 'Não', value: false },\n]\n\nconst evidenceRequirementOptions = [\n    { key: '1', text: 'Nenhuma evidência', value: 'NONE' },\n    { key: '2', text: 'Evidência opcional', value: 'OPTIONAL' },\n    { key: '3', text: 'Evidência obrigatória', value: 'REQUIRED' },\n]\n\nconst defaultState = {\n    valueType: '',\n    hasData: '',\n    evidenceRequirement: '',\n    unit: '',\n    id: '',\n    title: '',\n    description: '',\n    code: '',\n    expression: '',\n    dependencies: '',\n    data: null\n}\n\nconst MetricsEditor = ({ id }) => {\n\n    const [info, setInfo] = useState({ ...defaultState })\n    const [isNewMetric, setIsNewMetric] = useState(true)\n    const [options, setOptions] = useState([])\n    const [orignalValueType, setOriginalValueType] = useState(null)\n\n    useEffect(() => {\n        const fetchData = async (id) => {\n\n            if (!id) return\n\n            try {\n                const { data } = await getMetricbyId(id)\n                setIsNewMetric(!!!data)\n                setInfo(data)\n                setOriginalValueType(data.valueType)\n            } catch {\n                setIsNewMetric(true)\n                setInfo({ ...defaultState, id: `${id}/` })\n            }\n        }\n\n        fetchData(id)\n    }, [id])\n\n    const handleChange = (name, value) => {\n        setInfo({ ...info, [name]: value })\n    }\n\n    // TODO, it makes the metric always be a SELECT\n    const onSubmit = async () => {\n        let data = info.data\n        if (!info.data || orignalValueType !== info.valueType)\n            data = info.valueType === 'SELECT'\n                ? { currentOption: options[0], options: options }\n                : ''\n\n        const submitInfo = { ...info, data }\n\n        try {\n            if (isNewMetric)\n                await postMetric(submitInfo)\n            else\n                await putMetric(submitInfo)\n            window.location.reload()\n        } catch (e) {\n            console.log(e)\n        }\n    }\n\n    const addOption = () => {\n        setOptions([...options, ''])\n    }\n\n    const removeOption = () => {\n        setOptions(options.slice(0, -1))\n    }\n\n    const handleChangeOption = (index, value) => {\n        const newOptions = [...options]\n        newOptions[index] = value\n        setOptions(newOptions)\n    }\n\n    return (\n        <Form onSubmit={onSubmit}>\n            <Form.Field>\n                <Checkbox\n                    checked={!isNewMetric}\n                    label={'Atualizar ID'}\n                    onChange={(e, { checked }) => { setIsNewMetric(!checked) }} />\n            </Form.Field>\n            <Form.Group widths='equal'>\n                <Form.Select\n                    options={typesOptions}\n                    placeholder='Tipo'\n                    label='Tipo'\n                    name='valueType'\n                    value={info.valueType}\n                    onChange={(e, { name, value }) => handleChange(name, value)}\n                />\n                <Form.Select\n                    options={hasDataOptions}\n                    placeholder='O campo é editável?'\n                    label='Dados'\n                    name='hasData'\n                    value={info.hasData}\n                    onChange={(e, { name, value }) => handleChange(name, value)}\n                />\n            </Form.Group>\n            <Form.Group widths='equal'>\n                <Form.Select\n                    options={evidenceRequirementOptions}\n                    placeholder='O campo possui evidência?'\n                    label='Evidência'\n                    name='evidenceRequirement'\n                    value={info.evidenceRequirement}\n                    onChange={(e, { name, value }) => handleChange(name, value)}\n                />\n                <Form.Input\n                    label=\"Unidade\"\n                    placeholder=\"Ex: m², %\"\n                    name='unit'\n                    value={info.unit}\n                    onChange={({ target }) => handleChange(target.name, target.value)}\n                />\n            </Form.Group>\n            <Form.Group widths='equal'>\n                <Form.Input\n                    disabled={!isNewMetric}\n                    label=\"ID\"\n                    placeholder=\"Valor único de identificação da métrica no banco de dados\"\n                    name='id'\n                    value={info.id}\n                    onChange={({ target }) => handleChange(target.name, target.value)}\n                />\n                <Form.Input\n                    label=\"Título\"\n                    placeholder=\"Nome da métrica\"\n                    name='title'\n                    value={info.title}\n                    onChange={({ target }) => handleChange(target.name, target.value)}\n                />\n            </Form.Group>\n            <Form.TextArea\n                label=\"Descrição\"\n                placeholder=\"Descreva em palavras como calcular esta métrica\"\n                name='description'\n                value={info.description}\n                onChange={({ target }) => handleChange(target.name, target.value)}\n            />\n            <Form.Input\n                label=\"Code\"\n                placeholder=\"Valor usado para criação do dashboard\"\n                name='code'\n                value={info.code}\n                onChange={({ target }) => handleChange(target.name, target.value)}\n            />\n            <Form.Input\n                label=\"Expressão\"\n                placeholder=\"Fórmula matemática para calcular a métrica\"\n                name='expression'\n                value={info.expression}\n                onChange={({ target }) => handleChange(target.name, target.value)}\n            />\n            {info.valueType === 'SELECT' &&\n                <>\n                    <p>Opções</p>\n                    {options.map((el, index) =>\n                        <Form.Input\n                            key={index}\n                            placeholder=\"Opção 1\"\n                            name='options'\n                            value={el.value}\n                            onChange={({ target }) => handleChangeOption(index, target.value)}\n                        />)}\n                    <Form.Group>\n                        <Form.Button\n                            color='green'\n                            type='button'\n                            onClick={() => { addOption() }}>\n                            Adicionar\n                        </Form.Button>\n                        <Form.Button\n                            color='red'\n                            type='button'\n                            onClick={() => { removeOption() }}>\n                            Remover\n                        </Form.Button>\n                    </Form.Group>\n                </>\n            }\n            <div className='app-footer'>\n                <Form.Button\n                    primary\n                    className=\"centered\"\n                    color='black'\n                    type='submit'>Enviar</Form.Button>\n            </div>\n        </Form>\n    )\n}\n\nexport default MetricsEditor"]},"metadata":{},"sourceType":"module"}